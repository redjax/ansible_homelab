THIS_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
export REPO_ROOT=$(realpath -m "$THIS_DIR/")

ANSIBLE_SSH_DIR="${REPO_ROOT}/.ssh"

## Tell Ansible where to look for ansible.cfg file
export ANSIBLE_CONFIG="${REPO_ROOT}/ansible.cfg"

## Override ansible.cfg values
export ANSIBLE_ROLES_PATH="${REPO_ROOT}/roles"
export ANSIBLE_INVENTORY="${REPO_ROOT}/inventories/homelab/inventory.yml"
export ANSIBLE_COLLECTIONS_PATHS="${REPO_ROOT}/collections/ansible_collections"
export ANSIBLE_LOCAL_TMP="${REPO_ROOT}/.ansible/tmp"

SSH_CONFIG_PATH="${ANSIBLE_SSH_DIR}/config"
if [[ -n "$SSH_CONFIG_PATH" && -f "$SSH_CONFIG_PATH" ]]; then
    export ANSIBLE_SSH_ARGS="-F ${SSH_CONFIG_PATH}"
fi

## Source local/gitignored .envrc.local
source_env_if_exists .envrc.local

########################
# Example .envrc.local #
########################
# 
# ## Override default ansible inventory file
# export ANSIBLE_INVENTORY="${REPO_ROOT}/inventories/example/inventory.yml"
#
